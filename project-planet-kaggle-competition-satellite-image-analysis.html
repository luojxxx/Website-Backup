<div class="main-content" data-collection-id="591cf8905016e1c2af3fcb5e" data-content-field="main-content" data-edit-main-image="" id="content">
<div class="sqs-layout sqs-grid-12 columns-12" data-type="page" data-updated-on="1707464854309" id="page-591cf8905016e1c2af3fcb5e"><div class="row sqs-row"><div class="col sqs-col-12 span-12"><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-d2d23568d23a0c2eca8d"><div class="sqs-block-content">
<div class="sqs-html-content">
<h1 style="white-space:pre-wrap;">Project: Planet Kaggle Competition - Satellite Image Analysis</h1>
</div>
</div></div><div class="sqs-block image-block sqs-block-image" data-aspect-ratio="95.29243937232525" data-block-type="5" id="block-yui_3_17_2_11_1495049797570_3831"><div class="sqs-block-content">
<div class="image-block-outer-wrapper layout-caption-below design-layout-inline combination-animation-none individual-animation-none individual-text-animation-none" data-test="image-block-inline-outer-wrapper">
<figure class="sqs-block-image-figure intrinsic" style="max-width:801px;">
<div class="image-block-wrapper" data-animation-role="image">
<div class="sqs-image-shape-container-element has-aspect-ratio" style="
                position: relative;
                
                  padding-bottom:95.29244232177734%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              ">
<img alt="" data-image="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1515464057147-NZIIISVY8E2TDD4LLRIA/computervision.png" data-image-dimensions="801x804" data-image-focal-point="0.5,0.5" data-load="false" data-loader="sqs" data-src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1515464057147-NZIIISVY8E2TDD4LLRIA/computervision.png" data-stretch="false" decoding="async" elementtiming="system-image-block" height="804" loading="lazy" onload='this.classList.add("loaded")' sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1515464057147-NZIIISVY8E2TDD4LLRIA/computervision.png" srcset="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1515464057147-NZIIISVY8E2TDD4LLRIA/computervision.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1515464057147-NZIIISVY8E2TDD4LLRIA/computervision.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1515464057147-NZIIISVY8E2TDD4LLRIA/computervision.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1515464057147-NZIIISVY8E2TDD4LLRIA/computervision.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1515464057147-NZIIISVY8E2TDD4LLRIA/computervision.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1515464057147-NZIIISVY8E2TDD4LLRIA/computervision.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1515464057147-NZIIISVY8E2TDD4LLRIA/computervision.png?format=2500w 2500w" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" width="801"/>
</div>
</div>
</figure>
</div>
</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_11_1495049797570_4109"><div class="sqs-block-content">
<div class="sqs-html-content">
<h2 style="white-space:pre-wrap;">The motivation</h2><p class="" style="white-space:pre-wrap;">When machine learning finally evolved into a technology usable by the masses, it seemed like a super power. The whole idea of asking a computer to recognize something for you, and have it look through more data and with greater consistency than a person could do was game-changing.</p><p class="" style="white-space:pre-wrap;">But being new to the game, I needed to give this newfound superpower some exercise, so I went to Kaggle to find a competition to stretch my legs. Luckily there was a cool competition to classify satellite imagery in order to protect the rainforest. The idea was that the images were broken down into smaller tiles that were individually classified so that you could monitor how human developments and the rainforests were changing.</p>
</div>
</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_3_1495482034305_35142"><div class="sqs-block-content">
<div class="image-block-outer-wrapper layout-caption-below design-layout-inline combination-animation-none individual-animation-none individual-text-animation-none" data-test="image-block-inline-outer-wrapper">
<figure class="sqs-block-image-figure intrinsic" style="max-width:2300px;">
<div class="image-block-wrapper" data-animation-role="image">
<div class="sqs-image-shape-container-element has-aspect-ratio" style="
                position: relative;
                
                  padding-bottom:34.173912048339844%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              ">
<img alt="" data-image="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485935995-WLWRG91MH864TH3S3XMB/chips.jpg" data-image-dimensions="2300x786" data-image-focal-point="0.5,0.5" data-load="false" data-loader="sqs" data-src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485935995-WLWRG91MH864TH3S3XMB/chips.jpg" data-stretch="false" decoding="async" elementtiming="system-image-block" height="786" loading="lazy" onload='this.classList.add("loaded")' sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485935995-WLWRG91MH864TH3S3XMB/chips.jpg" srcset="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485935995-WLWRG91MH864TH3S3XMB/chips.jpg?format=100w 100w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485935995-WLWRG91MH864TH3S3XMB/chips.jpg?format=300w 300w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485935995-WLWRG91MH864TH3S3XMB/chips.jpg?format=500w 500w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485935995-WLWRG91MH864TH3S3XMB/chips.jpg?format=750w 750w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485935995-WLWRG91MH864TH3S3XMB/chips.jpg?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485935995-WLWRG91MH864TH3S3XMB/chips.jpg?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485935995-WLWRG91MH864TH3S3XMB/chips.jpg?format=2500w 2500w" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" width="2300"/>
</div>
</div>
</figure>
</div>
</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_8_1495572235979_11949"><div class="sqs-block-content">
<div class="sqs-html-content">
<h2 style="white-space:pre-wrap;">Random Forest with RGB Statistics</h2><p class="" style="white-space:pre-wrap;">Luckily someone posted a quick getting started script that ran through a basic classifier using RGB statistics, which also included basic data import and formatting the submission. And while it originally called for the XGBClassifier, I substituted it out for a random forest model, since that was a part of the well-maintained sci-kit learn library. Plus random forest is my favorite machine learning algorithm being quick and usually getting a decent result =)</p><p class="" style="white-space:pre-wrap;">The RGB statistics was an interesting choice of feature using the mean, standard deviation, max, min, kurtosis, and skewness of each RGB channel across the image. Since these are aggregate statistics across the image, it removes the spatial information making the classifier essentially translationally invariant. Meaning white clouds could show up on any part of the image, and be classified as clouds. Of course, this also means white buildings could be confused as clouds or vice versa, since there is a substantial amount of information being lost.</p><p class="" style="white-space:pre-wrap;">But either way I gave it a shot, the random forest was set with 100 trees with all else being defaults, a random seed was set, the data was shuffled, and with 40479 samples a 80/10/10 split for training/validation/test sets. This was run at 5-times replicate while re-shuffling the dataset for each run. The aggregate results on the test set are reported below.</p>
</div>
</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_3_1495409701835_11472"><div class="sqs-block-content">
<div class="image-block-outer-wrapper layout-caption-below design-layout-inline combination-animation-none individual-animation-none individual-text-animation-none" data-test="image-block-inline-outer-wrapper">
<figure class="sqs-block-image-figure intrinsic" style="max-width:1387px;">
<div class="image-block-wrapper" data-animation-role="image">
<div class="sqs-image-shape-container-element has-aspect-ratio" style="
                position: relative;
                
                  padding-bottom:56.6690673828125%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              ">
<img alt="" data-image="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495409864657-17PLD5VF3ACTH3NEQ9TH/rgbstats5.png" data-image-dimensions="1387x786" data-image-focal-point="0.5,0.5" data-load="false" data-loader="sqs" data-src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495409864657-17PLD5VF3ACTH3NEQ9TH/rgbstats5.png" data-stretch="false" decoding="async" elementtiming="system-image-block" height="786" loading="lazy" onload='this.classList.add("loaded")' sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495409864657-17PLD5VF3ACTH3NEQ9TH/rgbstats5.png" srcset="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495409864657-17PLD5VF3ACTH3NEQ9TH/rgbstats5.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495409864657-17PLD5VF3ACTH3NEQ9TH/rgbstats5.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495409864657-17PLD5VF3ACTH3NEQ9TH/rgbstats5.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495409864657-17PLD5VF3ACTH3NEQ9TH/rgbstats5.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495409864657-17PLD5VF3ACTH3NEQ9TH/rgbstats5.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495409864657-17PLD5VF3ACTH3NEQ9TH/rgbstats5.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495409864657-17PLD5VF3ACTH3NEQ9TH/rgbstats5.png?format=2500w 2500w" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" width="1387"/>
</div>
</div>
</figure>
</div>
</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_3_1495409701835_11750"><div class="sqs-block-content">
<div class="sqs-html-content">
<p class="" style="white-space:pre-wrap;">Individual F-Beta Scores for each run (beta=2 and average=sample):</p><p class="" style="white-space:pre-wrap;">0.83332, 0.83633, 0.84038, 0.83256, 0.83632</p><p class="" style="white-space:pre-wrap;">Combined F-Beta score: 0.83578</p><p class="" style="white-space:pre-wrap;">As we can see it does pretty well, even though it's essentially just looking at the the distribution of each RGB channel. However, it does particularly poorly on certain high frequency groups such as water and cultivation. To explain why it does poorly on water, it's best to look at some examples.</p>
</div>
</div></div><div class="sqs-block gallery-block sqs-block-gallery" data-block-json='{"hSize":null,"floatDir":null,"methodOption":"transient","existingGallery":null,"newWindow":false,"aspect-ratio":"square","aspectRatio":null,"auto-crop":true,"blockAnimation":"none","collectionId":"59234d793a0411d9007cbccb","design":"grid","lightbox":false,"padding":20,"show-meta":true,"show-meta-basic":true,"show-meta-only-title":false,"show-meta-only-description":false,"square-thumbs":true,"thumbnails-per-row":4,"vSize":null,"transientGalleryId":"59234d793a0411d9007cbccb"}' data-block-type="8" id="block-yui_3_17_2_3_1495482034305_18235"><div class="sqs-block-content">
<div class="sqs-gallery-container sqs-gallery-block-grid sqs-gallery-aspect-ratio-square sqs-gallery-thumbnails-per-row-4 sqs-gallery-block-show-meta block-animation-none clear">
<div class="sqs-gallery">
<div class="slide" data-animation-role="image" data-type="image">
<div class="margin-wrapper">
<a class="image-slide-anchor content-fill" role="presentation">
<noscript><img alt="train_25.jpg" src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485819630-DYD4DHN1JKN0JE3K08PB/train_25.jpg"/></noscript><img alt="train_25.jpg" class="thumb-image" data-image="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485819630-DYD4DHN1JKN0JE3K08PB/train_25.jpg" data-image-dimensions="256x256" data-image-focal-point="0.5,0.5" data-image-id="59234d7abe65942f47099f8f" data-load="false" data-src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485819630-DYD4DHN1JKN0JE3K08PB/train_25.jpg" data-type="image" elementtiming="system-gallery-block-grid">
</img></a>
</div>
</div>
<div class="slide" data-animation-role="image" data-type="image">
<div class="margin-wrapper">
<a class="image-slide-anchor content-fill" role="presentation">
<noscript><img alt="train_27.jpg" src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485819623-GEYZT1388GX1GDGEVNFI/train_27.jpg"/></noscript><img alt="train_27.jpg" class="thumb-image" data-image="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485819623-GEYZT1388GX1GDGEVNFI/train_27.jpg" data-image-dimensions="256x256" data-image-focal-point="0.5,0.5" data-image-id="59234d7bd2b857a995febe6b" data-load="false" data-src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485819623-GEYZT1388GX1GDGEVNFI/train_27.jpg" data-type="image" elementtiming="system-gallery-block-grid"/>
</a>
</div>
</div>
<div class="slide" data-animation-role="image" data-type="image">
<div class="margin-wrapper">
<a class="image-slide-anchor content-fill" role="presentation">
<noscript><img alt="train_32.jpg" src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485819916-S9CO6RRZYK36E96BJUJO/train_32.jpg"/></noscript><img alt="train_32.jpg" class="thumb-image" data-image="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485819916-S9CO6RRZYK36E96BJUJO/train_32.jpg" data-image-dimensions="256x256" data-image-focal-point="0.5,0.5" data-image-id="59234d7b3e00beed1b5b8c1b" data-load="false" data-src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485819916-S9CO6RRZYK36E96BJUJO/train_32.jpg" data-type="image" elementtiming="system-gallery-block-grid"/>
</a>
</div>
</div>
<div class="slide" data-animation-role="image" data-type="image">
<div class="margin-wrapper">
<a class="image-slide-anchor content-fill" role="presentation">
<noscript><img alt="train_67.jpg" src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485820235-OD22QZ9GRAUBZE1FHYMC/train_67.jpg"/></noscript><img alt="train_67.jpg" class="thumb-image" data-image="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485820235-OD22QZ9GRAUBZE1FHYMC/train_67.jpg" data-image-dimensions="256x256" data-image-focal-point="0.5,0.5" data-image-id="59234d7b1b631b06b83cd3de" data-load="false" data-src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485820235-OD22QZ9GRAUBZE1FHYMC/train_67.jpg" data-type="image" elementtiming="system-gallery-block-grid"/>
</a>
</div>
</div>
<div class="slide" data-animation-role="image" data-type="image">
<div class="margin-wrapper">
<a class="image-slide-anchor content-fill" role="presentation">
<noscript><img alt="train_24.jpg" src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485820409-FD4J4CBZM8CNNH0JIRZL/train_24.jpg"/></noscript><img alt="train_24.jpg" class="thumb-image" data-image="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485820409-FD4J4CBZM8CNNH0JIRZL/train_24.jpg" data-image-dimensions="256x256" data-image-focal-point="0.5,0.5" data-image-id="59234d7c6a496341d7c5a172" data-load="false" data-src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485820409-FD4J4CBZM8CNNH0JIRZL/train_24.jpg" data-type="image" elementtiming="system-gallery-block-grid"/>
</a>
</div>
</div>
<div class="slide" data-animation-role="image" data-type="image">
<div class="margin-wrapper">
<a class="image-slide-anchor content-fill" role="presentation">
<noscript><img alt="train_103.jpg" src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485820516-26ATUV452RIURTAGXOJX/train_103.jpg"/></noscript><img alt="train_103.jpg" class="thumb-image" data-image="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485820516-26ATUV452RIURTAGXOJX/train_103.jpg" data-image-dimensions="256x256" data-image-focal-point="0.5,0.5" data-image-id="59234d7c59cc682490279640" data-load="false" data-src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485820516-26ATUV452RIURTAGXOJX/train_103.jpg" data-type="image" elementtiming="system-gallery-block-grid"/>
</a>
</div>
</div>
<div class="slide" data-animation-role="image" data-type="image">
<div class="margin-wrapper">
<a class="image-slide-anchor content-fill" role="presentation">
<noscript><img alt="train_62.jpg" src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485820758-LDE9272N8DCTELMB1B6D/train_62.jpg"/></noscript><img alt="train_62.jpg" class="thumb-image" data-image="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485820758-LDE9272N8DCTELMB1B6D/train_62.jpg" data-image-dimensions="256x256" data-image-focal-point="0.5,0.5" data-image-id="59234d7c03596ed573bd1dfa" data-load="false" data-src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485820758-LDE9272N8DCTELMB1B6D/train_62.jpg" data-type="image" elementtiming="system-gallery-block-grid"/>
</a>
</div>
</div>
<div class="slide" data-animation-role="image" data-type="image">
<div class="margin-wrapper">
<a class="image-slide-anchor content-fill" role="presentation">
<noscript><img alt="train_10.jpg" src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485820962-MIADZGJQSZYULGYHWN2Z/train_10.jpg"/></noscript><img alt="train_10.jpg" class="thumb-image" data-image="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485820962-MIADZGJQSZYULGYHWN2Z/train_10.jpg" data-image-dimensions="256x256" data-image-focal-point="0.5,0.5" data-image-id="59234d7c17bffcfb95a0299d" data-load="false" data-src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485820962-MIADZGJQSZYULGYHWN2Z/train_10.jpg" data-type="image" elementtiming="system-gallery-block-grid"/>
</a>
</div>
</div>
<div class="slide" data-animation-role="image" data-type="image">
<div class="margin-wrapper">
<a class="image-slide-anchor content-fill" role="presentation">
<noscript><img alt="train_9.jpg" src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485821130-AROSTOHSRLRKNFCXSN33/train_9.jpg"/></noscript><img alt="train_9.jpg" class="thumb-image" data-image="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485821130-AROSTOHSRLRKNFCXSN33/train_9.jpg" data-image-dimensions="256x256" data-image-focal-point="0.5,0.5" data-image-id="59234d7db8a79b5289f1b57d" data-load="false" data-src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485821130-AROSTOHSRLRKNFCXSN33/train_9.jpg" data-type="image" elementtiming="system-gallery-block-grid"/>
</a>
</div>
</div>
<div class="slide" data-animation-role="image" data-type="image">
<div class="margin-wrapper">
<a class="image-slide-anchor content-fill" role="presentation">
<noscript><img alt="train_59.jpg" src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485821374-9KH65MZ093QIA1M18HUQ/train_59.jpg"/></noscript><img alt="train_59.jpg" class="thumb-image" data-image="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485821374-9KH65MZ093QIA1M18HUQ/train_59.jpg" data-image-dimensions="256x256" data-image-focal-point="0.5,0.5" data-image-id="59234d7d37c581bbfc176b53" data-load="false" data-src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495485821374-9KH65MZ093QIA1M18HUQ/train_59.jpg" data-type="image" elementtiming="system-gallery-block-grid"/>
</a>
</div>
</div>
</div>
</div>
<style id="design-grid-css" type="text/css">
#block-yui_3_17_2_3_1495482034305_18235 .sqs-gallery-block-grid .sqs-gallery-design-grid { margin-right: -20px; }
#block-yui_3_17_2_3_1495482034305_18235 .sqs-gallery-block-grid .sqs-gallery-design-grid-slide .margin-wrapper { margin-right: 20px; margin-bottom: 20px; }
</style>
</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_3_1495482034305_18331"><div class="sqs-block-content">
<div class="sqs-html-content">
<p class="" style="white-space:pre-wrap;">So sometimes brown means ground and sometimes brown means water. The reason why water is difficult is because we're dealing with very murky waters that isn't blue, and without additional information the classifier will have trouble telling the difference.</p><h2 style="white-space:pre-wrap;">Random Forest with RGB Statistics + Edge/Line Statistics</h2><p class="" style="white-space:pre-wrap;">Now there is a characteristic of water that we can exploit, the surface tends to be completely flat and uniform. This might already be picked up somewhat by the kurtosis and standard deviation, although it is an aggregate statistic over just three channels for the entire image. This sharp peak could be completely muddled by other colors. So if we can provide more information from another perspective, it might help the classifier differentiate and overall perform better.</p><p class="" style="white-space:pre-wrap;">So being flat and uniform, this also means there shouldn't be any edges on the surface of the water. So for fun, practice, and to use it, I implemented a quick website with a custom API to provide a graphical interface to quickly test different settings on some image processing algorithms that will return edges, lines, and corners. If you want to check it out, here's the <a href="https://dreamy-northcutt-31775d.netlify.app/">link</a>.</p>
</div>
</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_3_1495482034305_48877"><div class="sqs-block-content">
<div class="image-block-outer-wrapper layout-caption-below design-layout-inline combination-animation-none individual-animation-none individual-text-animation-none" data-test="image-block-inline-outer-wrapper">
<figure class="sqs-block-image-figure intrinsic" style="max-width:1358px;">
<a class="sqs-block-image-link" href="https://d3lbuaccn00s2o.cloudfront.net/">
<div class="image-block-wrapper" data-animation-role="image">
<div class="sqs-image-shape-container-element has-aspect-ratio" style="
                position: relative;
                
                  padding-bottom:66.71575927734375%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              ">
<img alt="" data-image="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495486972482-EFG1IZOJZ2OK2U6ADCNC/React_App.png" data-image-dimensions="1358x906" data-image-focal-point="0.5,0.5" data-load="false" data-loader="sqs" data-src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495486972482-EFG1IZOJZ2OK2U6ADCNC/React_App.png" data-stretch="false" decoding="async" elementtiming="system-image-block" height="906" loading="lazy" onload='this.classList.add("loaded")' sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495486972482-EFG1IZOJZ2OK2U6ADCNC/React_App.png" srcset="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495486972482-EFG1IZOJZ2OK2U6ADCNC/React_App.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495486972482-EFG1IZOJZ2OK2U6ADCNC/React_App.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495486972482-EFG1IZOJZ2OK2U6ADCNC/React_App.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495486972482-EFG1IZOJZ2OK2U6ADCNC/React_App.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495486972482-EFG1IZOJZ2OK2U6ADCNC/React_App.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495486972482-EFG1IZOJZ2OK2U6ADCNC/React_App.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495486972482-EFG1IZOJZ2OK2U6ADCNC/React_App.png?format=2500w 2500w" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" width="1358"/>
</div>
</div>
</a>
<figcaption class="image-caption-wrapper">
<div class="image-caption"><p class="" style="white-space:pre-wrap;">The canny edge threshold to be considered an edge was set very low, so that we get a zero value only when staring at the essentially featureless surface of water.</p></div>
</figcaption>
</figure>
</div>
</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_3_1495482034305_49153"><div class="sqs-block-content">
<div class="sqs-html-content">
<p class="" style="white-space:pre-wrap;">In addition, habitation and roads will often times have straight lines, while habitation should also be rich in corners.</p>
</div>
</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_3_1495482034305_55052"><div class="sqs-block-content">
<div class="image-block-outer-wrapper layout-caption-below design-layout-inline combination-animation-none individual-animation-none individual-text-animation-none" data-test="image-block-inline-outer-wrapper">
<figure class="sqs-block-image-figure intrinsic" style="max-width:1357px;">
<a class="sqs-block-image-link" href="https://d3lbuaccn00s2o.cloudfront.net/">
<div class="image-block-wrapper" data-animation-role="image">
<div class="sqs-image-shape-container-element has-aspect-ratio" style="
                position: relative;
                
                  padding-bottom:66.5438461303711%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              ">
<img alt="" data-image="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495505520731-K9D45HEYJXY81ADAAOME/React_App2.png" data-image-dimensions="1357x903" data-image-focal-point="0.5,0.5" data-load="false" data-loader="sqs" data-src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495505520731-K9D45HEYJXY81ADAAOME/React_App2.png" data-stretch="false" decoding="async" elementtiming="system-image-block" height="903" loading="lazy" onload='this.classList.add("loaded")' sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495505520731-K9D45HEYJXY81ADAAOME/React_App2.png" srcset="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495505520731-K9D45HEYJXY81ADAAOME/React_App2.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495505520731-K9D45HEYJXY81ADAAOME/React_App2.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495505520731-K9D45HEYJXY81ADAAOME/React_App2.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495505520731-K9D45HEYJXY81ADAAOME/React_App2.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495505520731-K9D45HEYJXY81ADAAOME/React_App2.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495505520731-K9D45HEYJXY81ADAAOME/React_App2.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495505520731-K9D45HEYJXY81ADAAOME/React_App2.png?format=2500w 2500w" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" width="1357"/>
</div>
</div>
</a>
<figcaption class="image-caption-wrapper">
<div class="image-caption"><p class="" style="white-space:pre-wrap;">The canny edge detector that feeds into the hough line detector was set relatively high, so that we avoid too many edges. If the image is just a cloud of edges, the hough line detector will be able to find lines in basically any direction. The hough line detector settings themselves are also set relatively high with a threshold at 100, so it'll only report a line when it's a very strong line. The harris corner settings were left at defaults.</p></div>
</figcaption>
</figure>
</div>
</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_3_1495482034305_55329"><div class="sqs-block-content">
<div class="sqs-html-content">
<p class="" style="white-space:pre-wrap;">However, we are not tuning the settings for each image, it's only one setting for the entire dataset. Even though one could make a machine learning algorithm to set the image processor settings based on the image, we're not going to do that at the moment. And as we can see below, due to these global settings sometimes they don't work out very well.</p>
</div>
</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_3_1495482034305_74417"><div class="sqs-block-content">
<div class="image-block-outer-wrapper layout-caption-below design-layout-inline combination-animation-none individual-animation-none individual-text-animation-none" data-test="image-block-inline-outer-wrapper">
<figure class="sqs-block-image-figure intrinsic" style="max-width:1367px;">
<a class="sqs-block-image-link" href="https://d3lbuaccn00s2o.cloudfront.net/">
<div class="image-block-wrapper" data-animation-role="image">
<div class="sqs-image-shape-container-element has-aspect-ratio" style="
                position: relative;
                
                  padding-bottom:66.49597930908203%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              ">
<img alt="" data-image="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495505552390-BZBDUA0MBC1F6ZERE0B3/wrongline2.png" data-image-dimensions="1367x909" data-image-focal-point="0.5,0.5" data-load="false" data-loader="sqs" data-src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495505552390-BZBDUA0MBC1F6ZERE0B3/wrongline2.png" data-stretch="false" decoding="async" elementtiming="system-image-block" height="909" loading="lazy" onload='this.classList.add("loaded")' sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495505552390-BZBDUA0MBC1F6ZERE0B3/wrongline2.png" srcset="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495505552390-BZBDUA0MBC1F6ZERE0B3/wrongline2.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495505552390-BZBDUA0MBC1F6ZERE0B3/wrongline2.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495505552390-BZBDUA0MBC1F6ZERE0B3/wrongline2.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495505552390-BZBDUA0MBC1F6ZERE0B3/wrongline2.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495505552390-BZBDUA0MBC1F6ZERE0B3/wrongline2.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495505552390-BZBDUA0MBC1F6ZERE0B3/wrongline2.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495505552390-BZBDUA0MBC1F6ZERE0B3/wrongline2.png?format=2500w 2500w" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" width="1367"/>
</div>
</div>
</a>
</figure>
</div>
</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_3_1495482034305_74694"><div class="sqs-block-content">
<div class="sqs-html-content">
<p class="" style="white-space:pre-wrap;">However, we'll still experiment with these additional features. Also to be more specific, we'll be using the sums of each edge/line/corner feature. For example for edges, there'll be an array of all the pixels on the image, and that pixel will either have a positive value representing the edge or zero, then we sum up the values across the array. These sums are appended to the existing RGB statistics training set. Also luckily because the random forest is a decision tree, we don't need to worry about scaling these values.</p><p class="" style="white-space:pre-wrap;">Model was setup with same settings as before with the only difference being the additional edge/line/corner statistics. (The random forest set with 100 trees with all else being defaults, a random seed was set, the data was shuffled, and with 40479 samples a 80/10/10 split for training/validation/test sets. This was run at 5-times replicate while re-shuffling the dataset for each run. The aggregate results on the test set are reported below.)</p>
</div>
</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_41_1495482034305_83322"><div class="sqs-block-content">
<div class="image-block-outer-wrapper layout-caption-below design-layout-inline combination-animation-none individual-animation-none individual-text-animation-none" data-test="image-block-inline-outer-wrapper">
<figure class="sqs-block-image-figure intrinsic" style="max-width:1387px;">
<div class="image-block-wrapper" data-animation-role="image">
<div class="sqs-image-shape-container-element has-aspect-ratio" style="
                position: relative;
                
                  padding-bottom:56.6690673828125%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              ">
<img alt="" data-image="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495510600230-624RZSAC3002Y6CYV8NO/rgbedgelinecornerstats5.png" data-image-dimensions="1387x786" data-image-focal-point="0.5,0.5" data-load="false" data-loader="sqs" data-src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495510600230-624RZSAC3002Y6CYV8NO/rgbedgelinecornerstats5.png" data-stretch="false" decoding="async" elementtiming="system-image-block" height="786" loading="lazy" onload='this.classList.add("loaded")' sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495510600230-624RZSAC3002Y6CYV8NO/rgbedgelinecornerstats5.png" srcset="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495510600230-624RZSAC3002Y6CYV8NO/rgbedgelinecornerstats5.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495510600230-624RZSAC3002Y6CYV8NO/rgbedgelinecornerstats5.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495510600230-624RZSAC3002Y6CYV8NO/rgbedgelinecornerstats5.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495510600230-624RZSAC3002Y6CYV8NO/rgbedgelinecornerstats5.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495510600230-624RZSAC3002Y6CYV8NO/rgbedgelinecornerstats5.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495510600230-624RZSAC3002Y6CYV8NO/rgbedgelinecornerstats5.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1495510600230-624RZSAC3002Y6CYV8NO/rgbedgelinecornerstats5.png?format=2500w 2500w" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" width="1387"/>
</div>
</div>
</figure>
</div>
</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_41_1495482034305_83600"><div class="sqs-block-content">
<div class="sqs-html-content">
<p class="" style="white-space:pre-wrap;">Individual F-Beta Scores for each run (beta=2 and average=sample):</p><p class="" style="white-space:pre-wrap;">0.83623, 0.84224, 0.84732, 0.8406, 0.84303</p><p class="" style="white-space:pre-wrap;">Combined F-Beta score: 0.84189</p><p class="" style="white-space:pre-wrap;">Looks like we were able to get a small improvement on average, and only by running randomized replicates we can have some confidence in detecting these small improvements, which is really what separates the top score from the rest. Luckily assuming a normal distribution and unequal variance, the two-sample T-test where the null hypothesis is that the two methods yield identical results on average is rejected with a one-sided p-value of 0.01453.</p><p class="" style="white-space:pre-wrap;">Submitting the results of this model run on the competition test set resulted in a F_beta score of <strong>0.83062.</strong></p><p class="" style="white-space:pre-wrap;">If we wanted to further pursue this direction, we would likely be able to get an even better result if we were to automate the exploration of the image processor hyperparameters. However, there are other things I want to try first.</p><h2 style="white-space:pre-wrap;">Deep Neural Networks on the cloud</h2><p class="" style="white-space:pre-wrap;">So specifically I want to try out deep convolutional neural networks, and training these models is a lot faster with a GPU. Unfortunately my computer is a Mac with a woefully underpowered GPU, so I decided to spin up a EC2 instance on Amazon Web Services.</p><p class="" style="white-space:pre-wrap;">I didn't really trust any of the AMIs that were out there that had this stuff installed (Keras, Tensorflow, Anaconda, CUDA, and cuDNN), so I setup the build process myself writing down the different bash commands I needed to get it done. Here are my notes in case anyone else is interested: </p><pre><code># Setup EC2 instance

sudo apt-get update
sudo apt install gcc
sudo apt-get install linux-headers-$(uname -r)

# Go to <a href="https://www.continuum.io/downloads">https://www.continuum.io/downloads</a> and set your installation parameters. Then modify the wget and bash to download and run the installation.

wget https://repo.continuum.io/archive/Anaconda3-4.3.1-Linux-x86_64.sh
bash Anaconda3-4.3.1-Linux-x86_64.sh
export PATH=/home/ubuntu/anaconda3/bin:$PATH

# When installing CUDA and cuDNN, google search 'Tensorflow gpu' and double check which versions to install. For instance, the tensorflow-gpu version as of writing used CUDA 8.0 and cuDNN 5.1, even though cuDNN 6.0 is the latest available. So double check
# Go to <a href="https://developer.nvidia.com/cuda-downloads">https://developer.nvidia.com/cuda-downloads</a> and set your installation parameters. Then modify the wget and dpkg to download and run the installation

wget <a href="http://developer.download.nvidia.com/compute/cuda/repos/ubuntu1404/x86_64/cuda-repo-ubuntu1404_8.0.61-1_amd64.deb">http://developer.download.nvidia.com/compute/cuda/repos/ubuntu1404/x86_64/cuda-repo-ubuntu1404_8.0.61-1_amd64.deb</a>
sudo dpkg -i cuda-repo-ubuntu1404_8.0.61-1_amd64.deb
sudo apt-get update
sudo apt-get install cuda

# NOTE: Their installation guide as of writing has a typo when setting the PATH, it isn't cuda-8.0.61, the folder is just cuda-8.0

export PATH=/usr/local/cuda-8.0/bin${PATH:+:${PATH}}
export LD_LIBRARY_PATH=/usr/local/cuda-8.0/lib64\
 ${LD_LIBRARY_PATH:+:${LD_LIBRARY_PATH}}

# Download files from <a href="https://developer.nvidia.com/rdp/cudnn-download">https://developer.nvidia.com/rdp/cudnn-download</a> (you'll need to sign up/sign in) and copy to computer/server.

sudo dpkg -i libcudnn5_5.1.10-1+cuda8.0_amd64.deb
pip install tensorflow-gpu
pip install keras</code></pre><p class="" style="white-space:pre-wrap;">And at this point you can just pip install whatever else you need. Currently a p2.xlarge holding a nvidia K80 is about $0.90 per hour, so it isn't too expensive, but after it all adds up it isn't cheap either.</p><h2 style="white-space:pre-wrap;">Deep neural network</h2><p class="" style="white-space:pre-wrap;">Designing the architecture of a neural network has often been considered a form of black magic. You kinda have an idea of what you're doing but it's difficult to figure out exactly how many layers, how many neurons per layer, etc without some form of trial and error.</p><p class="" style="white-space:pre-wrap;">However, there are certain high level ideas about the architecture that are very successful. Probably one of the most well known and popular one is fine-tuning a pre-trained network.</p><p class="" style="white-space:pre-wrap;">So what happens is you take a neural network that's been already carefully architected and trained on thousands of data points. And this output of this neural network is feed into a final output layer that's trained on the labels your trying to classify.</p><p class="" style="white-space:pre-wrap;">I personally used the Xception pretrained network that was already included in Keras, which was trained on the ImageNet dataset. So the output of this network is a list of probabilities of a particular classification like 13% chance of a watermelon, 68% chance of a ball, and etc. Now this output is used as an input for the final output layer to classify satellites image tiles as cloudy, river, habitation, etc.</p><p class="" style="white-space:pre-wrap;">But why does this work? Why would a neural network trained on mostly things that aren't our labels help? It's because some of those things look like the labels we care about. For instance, to the pretrained model a river can look like a river, but also a snake or garden hose. These other labels will have a higher output value, which our final output layer will learn how to synthesize together to produce a probability for our labels.</p><p class="" style="white-space:pre-wrap;">And since these pre-trained networks are so accurate and robust, we only need one layer with as many neurons as we have labels. So it's pretty straightforward.</p>
</div>
</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_4_1517358199597_42982"><div class="sqs-block-content">
<div class="image-block-outer-wrapper layout-caption-below design-layout-inline combination-animation-none individual-animation-none individual-text-animation-none" data-test="image-block-inline-outer-wrapper">
<figure class="sqs-block-image-figure intrinsic" style="max-width:908px;">
<div class="image-block-wrapper" data-animation-role="image">
<div class="sqs-image-shape-container-element has-aspect-ratio" style="
                position: relative;
                
                  padding-bottom:56.49779510498047%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              ">
<img alt="" data-image="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1517367013564-69RP57IPCYFLU0SDG9UQ/Kaggle-Planet-Satelite-Image-Classification_Keras4_ipynb_at_master_%C2%B7_luojxxx_Kaggle-Planet-Satelite-Image-Classification.png" data-image-dimensions="908x513" data-image-focal-point="0.5,0.5" data-load="false" data-loader="sqs" data-src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1517367013564-69RP57IPCYFLU0SDG9UQ/Kaggle-Planet-Satelite-Image-Classification_Keras4_ipynb_at_master_%C2%B7_luojxxx_Kaggle-Planet-Satelite-Image-Classification.png" data-stretch="false" decoding="async" elementtiming="system-image-block" height="513" loading="lazy" onload='this.classList.add("loaded")' sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1517367013564-69RP57IPCYFLU0SDG9UQ/Kaggle-Planet-Satelite-Image-Classification_Keras4_ipynb_at_master_%C2%B7_luojxxx_Kaggle-Planet-Satelite-Image-Classification.png" srcset="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1517367013564-69RP57IPCYFLU0SDG9UQ/Kaggle-Planet-Satelite-Image-Classification_Keras4_ipynb_at_master_%C2%B7_luojxxx_Kaggle-Planet-Satelite-Image-Classification.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1517367013564-69RP57IPCYFLU0SDG9UQ/Kaggle-Planet-Satelite-Image-Classification_Keras4_ipynb_at_master_%C2%B7_luojxxx_Kaggle-Planet-Satelite-Image-Classification.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1517367013564-69RP57IPCYFLU0SDG9UQ/Kaggle-Planet-Satelite-Image-Classification_Keras4_ipynb_at_master_%C2%B7_luojxxx_Kaggle-Planet-Satelite-Image-Classification.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1517367013564-69RP57IPCYFLU0SDG9UQ/Kaggle-Planet-Satelite-Image-Classification_Keras4_ipynb_at_master_%C2%B7_luojxxx_Kaggle-Planet-Satelite-Image-Classification.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1517367013564-69RP57IPCYFLU0SDG9UQ/Kaggle-Planet-Satelite-Image-Classification_Keras4_ipynb_at_master_%C2%B7_luojxxx_Kaggle-Planet-Satelite-Image-Classification.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1517367013564-69RP57IPCYFLU0SDG9UQ/Kaggle-Planet-Satelite-Image-Classification_Keras4_ipynb_at_master_%C2%B7_luojxxx_Kaggle-Planet-Satelite-Image-Classification.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1517367013564-69RP57IPCYFLU0SDG9UQ/Kaggle-Planet-Satelite-Image-Classification_Keras4_ipynb_at_master_%C2%B7_luojxxx_Kaggle-Planet-Satelite-Image-Classification.png?format=2500w 2500w" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" width="908"/>
</div>
</div>
</figure>
</div>
</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_4_1517358199597_43260"><div class="sqs-block-content">
<div class="sqs-html-content">
<p class="" style="white-space:pre-wrap;">Submitting the results of this model run on the competition test set resulted in a F_beta score of <strong>0.88813</strong>. A huge nearly 6% improvement!</p><h2 style="white-space:pre-wrap;">Feature Design</h2><p class="" style="white-space:pre-wrap;">Now there's this thing in machine learning called feature design. And the idea is that you want to make it as easy as possible for your machine learning algorithm to do it's job. So if you can preprocess the input so that it highlights the important information you want your machine learning algorithm to consider, it will perform better.</p><p class="" style="white-space:pre-wrap;">So what I did was combine the pre-trained Xception neural network output with the image RGB statistics into the final output layer. This was because I noticed the image RGB statistics performed better in certain areas compared to the fine tuned pre-trained network alone, particularly with clear, partly_cloudy, cloudy, and haze labels. This makes some sense, because it's essentially how white is the image. Also these labels were assigned to a large percentage of the images, so even a marginal improvement here can have a noticeable impact on overall accuracy.</p>
</div>
</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_4_1517358199597_65148"><div class="sqs-block-content">
<div class="image-block-outer-wrapper layout-caption-below design-layout-inline combination-animation-none individual-animation-none individual-text-animation-none" data-test="image-block-inline-outer-wrapper">
<figure class="sqs-block-image-figure intrinsic" style="max-width:998px;">
<div class="image-block-wrapper" data-animation-role="image">
<div class="sqs-image-shape-container-element has-aspect-ratio" style="
                position: relative;
                
                  padding-bottom:56.71342468261719%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              ">
<img alt="" data-image="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1517368113664-8U23PIC9UL9TJSWQ00UF/download.png" data-image-dimensions="998x566" data-image-focal-point="0.5,0.5" data-load="false" data-loader="sqs" data-src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1517368113664-8U23PIC9UL9TJSWQ00UF/download.png" data-stretch="false" decoding="async" elementtiming="system-image-block" height="566" loading="lazy" onload='this.classList.add("loaded")' sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" src="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1517368113664-8U23PIC9UL9TJSWQ00UF/download.png" srcset="https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1517368113664-8U23PIC9UL9TJSWQ00UF/download.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1517368113664-8U23PIC9UL9TJSWQ00UF/download.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1517368113664-8U23PIC9UL9TJSWQ00UF/download.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1517368113664-8U23PIC9UL9TJSWQ00UF/download.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1517368113664-8U23PIC9UL9TJSWQ00UF/download.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1517368113664-8U23PIC9UL9TJSWQ00UF/download.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/58e7f4d946c3c4645587ad7d/1517368113664-8U23PIC9UL9TJSWQ00UF/download.png?format=2500w 2500w" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" width="998"/>
</div>
</div>
</figure>
</div>
</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_4_1517358199597_65425"><div class="sqs-block-content">
<div class="sqs-html-content">
<p class="" style="white-space:pre-wrap;">Submitting the results of this model run on the competition test set resulted in a F_beta score of <strong>0.90007</strong> in position<strong> </strong>91 out of 253 as of writing.</p><h2 style="white-space:pre-wrap;">Conclusion</h2><p class="" style="white-space:pre-wrap;">After hitting the 0.9 threshold, I was pretty much satisfied with the result, and stopped working on it. I essentially got a A-!</p><p class="" style="white-space:pre-wrap;">This was approximately half way through the competition time. Eventually I went back and took a look at the final winning score, it was 0.93317. Not too far off from what I got.</p><p class="" style="white-space:pre-wrap;">It also appeared that the highest scoring competitors had a common optimization of trying out various pre-trained networks to fine-tune and picking the best result. I can see how that can definitely help move the score around 1 or 2 percentage points.</p><p class="" style="white-space:pre-wrap;">Overall, it was extremely fun and I learned a lot. It's super cool to try to build something to help save the Amazon rainforest, and I'm definitely looking for the free time to dip my toes back into machine learning again!</p>
</div>
</div></div></div></div></div>
</div>